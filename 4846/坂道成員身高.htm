<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‚é“æˆå“¡èº«é«˜çµ±è¨ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            // -webkit-text-fill-color: transparent;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-title {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
        }
        
        .chart-container {
            position: relative;
            margin-bottom: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            height: 450px;
        }
        
        .chart-container.small {
            height: 350px;
        }
        
        .chart-wrapper {
            position: relative;
            height: 400px;
        }
        
        .chart-wrapper.small {
            height: 300px;
        }
        
        canvas {
            max-height: 400px !important;
        }
        
        .chart-title {
            text-align: center;
            color: #555;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .tab-button {
            padding: 12px 25px;
            margin: 5px;
            border: none;
            background: #f0f0f0;
            color: #666;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1em;
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: scale(1.05);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
            max-height: 600px;
            overflow-y: auto;
            position: relative;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        thead {
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }
        
        tbody tr:hover {
            background: #f5f5f5;
        }
        
        .period-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
            
            .chart-container {
                height: 350px;
            }
            
            .chart-wrapper {
                height: 300px;
            }
            
            canvas {
                max-height: 300px !important;
            }
            
            .period-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
			<font color="#9400d3">&#x25e2;</font><font color="#ffb6c1">&#x25e2;</font><font color="#87ceeb">&#x25e2;</font>
			<font color="#964bc2">å‚é“æˆå“¡èº«é«˜çµ±è¨ˆ</font>
			ğŸ“Š
		</h1>
        
        <!-- çµ±è¨ˆåƒæ•¸ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-title">ç¸½äººæ•¸</div>
                <div class="stat-value" id="totalCount">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">å¹³å‡èº«é«˜</div>
                <div class="stat-value" id="meanHeight">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">ä¸­ä½æ•¸</div>
                <div class="stat-value" id="medianHeight">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">æ¨™æº–å·®</div>
                <div class="stat-value" id="stdDev">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">æœ€é«˜èº«é«˜</div>
                <div class="stat-value" id="maxHeight">-</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">æœ€ä½èº«é«˜</div>
                <div class="stat-value" id="minHeight">-</div>
            </div>
        </div>
        
        <!-- æ¨™ç±¤é  -->
        <div class="tabs">
            <button class="tab-button active" onclick="showTab('overview', this)">ç¸½è¦½</button>
            <button class="tab-button" onclick="showTab('byGroup', this)">æŒ‰åœ˜é«”</button>
            <button class="tab-button" onclick="showTab('byPeriod', this)">æŒ‰æœŸåˆ¥</button>
            <button class="tab-button" onclick="showTab('distribution', this)">åˆ†å¸ƒåœ–</button>
            <button class="tab-button" onclick="showTab('ranking', this)">æ’åè¡¨</button>
        </div>
        
        <!-- ç¸½è¦½ -->
        <div id="overview" class="tab-content active">
            <div class="chart-container">
                <h3 class="chart-title">èº«é«˜åˆ†å¸ƒç›´æ–¹åœ–</h3>
                <div class="chart-wrapper">
                    <canvas id="histogramChart" width="800" height="400"></canvas>
                </div>
            </div>
        </div>
        
        <!-- æŒ‰åœ˜é«”åˆ†æ -->
        <div id="byGroup" class="tab-content">
            <div class="chart-container">
                <h3 class="chart-title">å„åœ˜å¹³å‡èº«é«˜</h3>
                <div class="chart-wrapper">
                    <canvas id="groupChart"></canvas>
                </div>
            </div>
            <div class="chart-container">
                <h3 class="chart-title">å„åœ˜èº«é«˜ç®±å½¢åœ–</h3>
                <div class="chart-wrapper">
                    <canvas id="boxChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- æŒ‰æœŸåˆ¥åˆ†æ -->
        <div id="byPeriod" class="tab-content">
            <div class="period-grid">
                <div class="chart-container small">
                    <h3 class="chart-title">ä¹ƒæœ¨å‚46 å„æœŸåˆ¥å¹³å‡èº«é«˜</h3>
                    <div class="chart-wrapper small">
                        <canvas id="nogizakaPeriodChart"></canvas>
                    </div>
                </div>
                <div class="chart-container small">
                    <h3 class="chart-title">æ«»å‚46 å„æœŸåˆ¥å¹³å‡èº«é«˜</h3>
                    <div class="chart-wrapper small">
                        <canvas id="sakurazakaPeriodChart"></canvas>
                    </div>
                </div>
                <div class="chart-container small">
                    <h3 class="chart-title">æ—¥å‘å‚46 å„æœŸåˆ¥å¹³å‡èº«é«˜</h3>
                    <div class="chart-wrapper small">
                        <canvas id="hinatazakaPeriodChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- åˆ†å¸ƒåœ– -->
        <div id="distribution" class="tab-content">
            <div class="chart-container">
                <h3 class="chart-title">èº«é«˜å€é–“åˆ†å¸ƒ</h3>
                <div class="chart-wrapper">
                    <canvas id="pieChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- æ’åè¡¨ -->
        <div id="ranking" class="tab-content">
            <div class="table-container">
                <table id="rankingTable">
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>å§“å</th>
                            <th>åœ˜é«”</th>
                            <th>æœŸåˆ¥</th>
                            <th>èº«é«˜(cm)</th>
                        </tr>
                    </thead>
                    <tbody id="rankingBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script>
        // å„²å­˜æ‰€æœ‰åœ–è¡¨å¯¦ä¾‹
        const charts = {};
        
        // åŸå§‹è³‡æ–™
        const rawData = `åœ˜é«”	åŠ å…¥æ™‚æœŸ	æˆå“¡	Height(cm)
æ«»å‚46/æ¬…å‚46	1æœŸ	åœŸç”Ÿç‘ç©‚	171.6
æ—¥å‘å‚46	3æœŸ	é«™æ©‹æœªæ¥è™¹	170.6
ä¹ƒæœ¨å‚46	3æœŸ	æ¢…æ¾¤ç¾æ³¢	170.0
æ«»å‚46	4æœŸ	ç›®é»’é™½è‰²	169.4
æ¬…å‚46	1æœŸ	å¿—ç”°æ„›ä½³	169.0
æ«»å‚46	2æœŸ	æ¾å¹³ç’ƒå­	169.0
æ«»å‚46	2æœŸ	å±±ï¨‘å¤©	168.4
æ—¥å‘å‚46	1æœŸ	ä½ã€…æœ¨ä¹…ç¾	168.3
æ«»å‚46	3æœŸ	æ‘å±±ç¾ç¾½	168.0
ä¹ƒæœ¨å‚46	1æœŸ	å®®æ¾¤æˆè‰¯	168.0
æ—¥å‘å‚46	2æœŸ	æ¿±å²¸ã²ã‚ˆã‚Š	167.5
æ¬…å‚46/æ«»å‚46	1æœŸ	æ¸¡é‚‰ç†ä½	167.0
æ«»å‚46	2æœŸ	é–¢æœ‰ç¾å­	167.0
æ«»å‚46	3æœŸ	çš„é‡ç¾é’	167.0
ä¹ƒæœ¨å‚46	3æœŸ	ä¸­æ‘éº—ä¹ƒ	167.0
ä¹ƒæœ¨å‚46	4æœŸ	æ¾å°¾ç¾ä½‘	167.0
æ«»å‚46	4æœŸ	å‹åˆæ˜¥	167.0
æ¬…å‚46/æ«»å‚46	1æœŸ	æ¸¡è¾ºæ¢¨åŠ 	166.5
æ«»å‚46	2æœŸ	è—¤å‰å¤éˆ´	166.0
ä¹ƒæœ¨å‚46	2æœŸ	ä¼Šè—¤ç´”å¥ˆ	166.0
ä¹ƒæœ¨å‚46	4æœŸ	è³€å–œé¥é¦™	166.0
ä¹ƒæœ¨å‚46	5æœŸ	äº”ç™¾åŸèŒ‰å¤®	166.0
ä¹ƒæœ¨å‚46	6æœŸ	æµ·é‚‰æœ±è‰	166.0
ä¹ƒæœ¨å‚46	1æœŸ	æ–è—¤ã¡ã¯ã‚‹	166.0
æ—¥å‘å‚46	5æœŸ	é¶´å´ä»é¦™	166.0
æ—¥å‘å‚46	1æœŸ	ä½ã€…æœ¨ç¾ç²	165.7
æ—¥å‘å‚46	2æœŸ	å¯Œç”°éˆ´èŠ±	165.2
ä¹ƒæœ¨å‚46	2æœŸ	æ–°å†…çœè¡£	165.0
ä¹ƒæœ¨å‚46	4æœŸ	é‡‘å·ç´—è€¶	165.0
ä¹ƒæœ¨å‚46	4æœŸ	åŒ—å·æ‚ ç†	165.0
ä¹ƒæœ¨å‚46	4æœŸ	å¼“æœ¨å¥ˆæ–¼	165.0
ä¹ƒæœ¨å‚46	2æœŸ	è¥¿å·ä¸ƒæµ·	165.0
æ¬…å‚46/æ«»å‚46	1æœŸ	è…äº•å‹é¦™	165.0
æ«»å‚46	3æœŸ	å°å³¶å‡ªç´—	165.0
æ—¥å‘å‚46	4æœŸ	æ¸…æ°´ç†å¤®	165.0
æ—¥å‘å‚46	4æœŸ	å®®åœ°ã™ã¿ã‚Œ	165.0
æ—¥å‘å‚46	4æœŸ	å°è¥¿å¤èœå®Ÿ	164.8
ä¹ƒæœ¨å‚46	4æœŸ	é è—¤ã•ãã‚‰	164.0
ä¹ƒæœ¨å‚46	2æœŸ	ç›¸æ¥½ä¼Šç¹”	164.0
ä¹ƒæœ¨å‚46	4æœŸ	æ¸…å®®ãƒ¬ã‚¤	164.0
ä¹ƒæœ¨å‚46	5æœŸ	å†¨é‡Œå¥ˆå¤®	164.0
ä¹ƒæœ¨å‚46	4æœŸ	æ—©å·è–æ¥	164.0
ä¹ƒæœ¨å‚46	4æœŸ	æ—ç‘ å¥ˆ	164.0
ä¹ƒæœ¨å‚46	1æœŸ	æ¾æ‘æ²™å‹ç†	164.0
ä¹ƒæœ¨å‚46	2æœŸ	å±±ï¨‘æ€œå¥ˆ	164.0
ä¹ƒæœ¨å‚46	6æœŸ	å¤§è¶Šã²ãªã®	164.0
æ«»å‚46	4æœŸ	å±±ç”°æ¡ƒå®Ÿ	164.0
æ—¥å‘å‚46	5æœŸ	é«˜äº•ä¿é¦™	164.0
æ¬…å‚46/æ«»å‚46	1æœŸ	å®ˆå±‹èŒœ	163.5
æ«»å‚46	2æœŸ	é è—¤å…‰è‰	163.3
ä¹ƒæœ¨å‚46	1æœŸ	è¡›è—¤ç¾å½©	163.0
ä¹ƒæœ¨å‚46	2æœŸ	ä½ã€…æœ¨ç´å­	163.0
ä¹ƒæœ¨å‚46	1æœŸ	èƒ½æ¢æ„›æœª	163.0
ä¹ƒæœ¨å‚46	1æœŸ	æ©‹æœ¬å¥ˆã€…æœª	163.0
ä¹ƒæœ¨å‚46	4æœŸ	é»’è¦‹æ˜é¦™	163.0
ä¹ƒæœ¨å‚46	2æœŸ	ç±³å¾³äº¬èŠ±	163.0
æ«»å‚46	2æœŸ	å¤§åœ’ç²	163.0
æ«»å‚46	2æœŸ	äº•ä¸Šæ¢¨å	163.0
æ«»å‚46	2æœŸ	ç”°æ‘ä¿ä¹ƒ	163.0
æ«»å‚46	3æœŸ	å°ç”°å€‰éº—å¥ˆ	163.0
æ«»å‚46	3æœŸ	å‘äº•ç´”è‘‰	163.0
æ—¥å‘å‚46	2æœŸ	é‡‘æ‘ç¾ç–	163.0
æ—¥å‘å‚46	3æœŸ	ä¸Šæ‘ã²ãªã®	163.0
æ—¥å‘å‚46	5æœŸ	å¤§ç”°ç¾æœˆ	163.0
æ¬…å‚46	1æœŸ	çŸ³æ£®è™¹èŠ±	162.7
æ—¥å‘å‚46	3æœŸ	æ£®æœ¬èŒ‰è‰	162.4
æ¬…å‚46	1æœŸ	ç¹”ç”°å¥ˆé‚£	162.0
æ«»å‚46	3æœŸ	ä¸­å¶‹å„ªæœˆ	162.0
æ«»å‚46	4æœŸ	æ¾æœ¬å’Œå­	162.0
æ—¥å‘å‚46	1æœŸ	é«˜æœ¬å½©èŠ±	162.0
ä¹ƒæœ¨å‚46	1æœŸ	ç™½çŸ³éº»è¡£	162.0
ä¹ƒæœ¨å‚46	1æœŸ	é«˜å±±ä¸€å®Ÿ	162.0
ä¹ƒæœ¨å‚46	1æœŸ	æ·±å·éº»è¡£	162.0
ä¹ƒæœ¨å‚46	2æœŸ	å €æœªå¤®å¥ˆ	162.0
ä¹ƒæœ¨å‚46	äº¤æ›ç•™å­¸ç”Ÿ	æ¾äº•ç²å¥ˆ	162.0
ä¹ƒæœ¨å‚46	1æœŸ	å¤§å’Œé‡Œèœ	162.0
æ—¥å‘å‚46	2æœŸ	å°å‚èœç·’	161.5
ä¹ƒæœ¨å‚46	3æœŸ	ä¹…ä¿å²ç·’é‡Œ	161.0
ä¹ƒæœ¨å‚46	1æœŸ	å·å¾Œé™½èœ	161.0
ä¹ƒæœ¨å‚46	3æœŸ	é˜ªå£ç ç¾	161.0
ä¹ƒæœ¨å‚46	3æœŸ	ä½è—¤æ¥“	161.0
ä¹ƒæœ¨å‚46	2æœŸ	éˆ´æœ¨çµ¢éŸ³	161.0
ä¹ƒæœ¨å‚46	1æœŸ	ä¸­å…ƒæ—¥èŠ½é¦™	161.0
ä¹ƒæœ¨å‚46	1æœŸ	æ¨‹å£æ—¥å¥ˆ	161.0
ä¹ƒæœ¨å‚46	3æœŸ	å‰ç”°ç¶¾ä¹ƒã‚¯ãƒªã‚¹ãƒ†ã‚£ãƒ¼	161.0
ä¹ƒæœ¨å‚46	1æœŸ	å’Œç”°ã¾ã‚ã‚„	161.0
ä¹ƒæœ¨å‚46	6æœŸ	çŸ¢ç”°èŒè¯	161.0
æ¬…å‚46	1æœŸ	ä½è—¤è©©ç¹”	161.0
æ¬…å‚46/æ«»å‚46	1æœŸ	å°æ—ç”±ä¾	161.0
æ—¥å‘å‚46	4æœŸ	å±±ä¸‹è‘‰ç•™èŠ±	160.6
æ—¥å‘å‚46	1æœŸ	åŠ è—¤å²å¸†	160.5
æ—¥å‘å‚46	4æœŸ	è—¤å¶Œæœæ­©	160.4
ä¹ƒæœ¨å‚46	1æœŸ	ç”Ÿç”°çµµæ¢¨èŠ±	160.0
ä¹ƒæœ¨å‚46	1æœŸ	æŸå¹¸å¥ˆ	160.0
ä¹ƒæœ¨å‚46	4æœŸ	ä½è—¤ç’ƒæœ	160.0
ä¹ƒæœ¨å‚46	4æœŸ	æŸ´ç”°æŸšèœ	160.0
ä¹ƒæœ¨å‚46	4æœŸ	ç”°æ‘çœŸä½‘	160.0
ä¹ƒæœ¨å‚46	4æœŸ	ç­’äº•ã‚ã‚„ã‚	160.0
ä¹ƒæœ¨å‚46	3æœŸ	å±±ä¸‹ç¾æœˆ	160.0
ä¹ƒæœ¨å‚46	6æœŸ	æ„›å®•å¿ƒéŸ¿	160.0
æ—¥å‘å‚46	5æœŸ	å‚äº•æ–°å¥ˆ	160.0
æ«»å‚46	2æœŸ	æ¾ç”°é‡Œå¥ˆ	159.5
ä¹ƒæœ¨å‚46	5æœŸ	äº•ä¸Šå’Œ	159.5
ä¹ƒæœ¨å‚46	5æœŸ	å²¡æœ¬å§«å¥ˆ	159.5
æ—¥å‘å‚46	5æœŸ	ä½è—¤å„ªç¾½	159.4
æ—¥å‘å‚46	2æœŸ	å®®ç”°æ„›èŒ	159.3
æ—¥å‘å‚46	5æœŸ	æ¾å°¾æ¡œ	159.2
æ«»å‚46	3æœŸ	çŸ³æ£®ç’ƒèŠ±	159.0
æ«»å‚46	4æœŸ	å±±å·å®‡è¡£	159.0
ä¹ƒæœ¨å‚46	5æœŸ	æ± ç”°ç‘›ç´—	159.0
ä¹ƒæœ¨å‚46	3æœŸ	å²©æœ¬è“®åŠ 	159.0
æ¬…å‚46	1æœŸ	ç±³è°·å¥ˆã€…æœª	159.0
æ¬…å‚46	1.5æœŸ	é•·æ¿±ã­ã‚‹	159.0
ä¹ƒæœ¨å‚46	1æœŸ	æ°¸å³¶è–ç¾…	159.0
ä¹ƒæœ¨å‚46	1æœŸ	è¥¿é‡ä¸ƒç€¬	159.0
æ—¥å‘å‚46	4æœŸ	å¹³å°¾å¸†å¤	158.5
æ¬…å‚46/æ«»å‚46	1æœŸ	å°æ± ç¾æ³¢	158.5
æ«»å‚46	2æœŸ	æ­¦å…ƒå”¯è¡£	158.5
æ—¥å‘å‚46	4æœŸ	æ­£æºå¸é™½å­	158.4
æ«»å‚46	2æœŸ	å¢—æœ¬ç¶ºè‰¯	158.4
æ—¥å‘å‚46	2æœŸ	æ¸¡é‚‰ç¾ç©‚	158.2
æ¬…å‚46/æ«»å‚46	1æœŸ	é½‹è—¤å†¬å„ªèŠ±	158.0
ä¹ƒæœ¨å‚46	1æœŸ	ä¼Šè—¤ä¸‡ç†è¯	158.0
ä¹ƒæœ¨å‚46	2æœŸ	åŒ—é‡æ—¥å¥ˆå­	158.0
ä¹ƒæœ¨å‚46	1æœŸ	å·æ‘çœŸæ´‹	158.0
ä¹ƒæœ¨å‚46	1æœŸ	ä¸­ç”°èŠ±å¥ˆ	158.0
æ¬…å‚46	1æœŸ	é•·æ²¢èœã€…é¦™	158.0
æ¬…å‚46	1æœŸ	éˆ´æœ¨æ³‰å¸†	158.0
ä¹ƒæœ¨å‚46	1æœŸ	é½‹è—¤é£›é³¥	158.0
æ—¥å‘å‚46	4æœŸ	å¹³å²¡æµ·æœˆ	157.9
ä¹ƒæœ¨å‚46	1æœŸ	è‹¥æœˆä½‘ç¾	157.5
æ—¥å‘å‚46	1æœŸ	æ½®ç´—ç†èœ	157.5
æ—¥å‘å‚46	2æœŸ	æ¾ç”°å¥½èŠ±	157.5
æ—¥å‘å‚46	1æœŸ	é«˜ç€¬æ„›å¥ˆ	157.2
ä¹ƒæœ¨å‚46	5æœŸ	å¥¥ç”°ã„ã‚ã¯	157.0
ä¹ƒæœ¨å‚46	1æœŸ	æ–‰è—¤å„ªé‡Œ	157.0
ä¹ƒæœ¨å‚46	1æœŸ	æ¡œäº•ç²é¦™	157.0
ä¹ƒæœ¨å‚46	5æœŸ	è…åŸå’²æœˆ	157.0
ä¹ƒæœ¨å‚46	5æœŸ	ä¸­è¥¿ã‚¢ãƒ«ãƒ	157.0
ã‘ã‚„ãå‚46/æ—¥å‘å‚46	1æœŸ	æŸ¿å´èŠ½å®Ÿ	157.0
æ—¥å‘å‚46	2æœŸ	ä¸¹ç”Ÿæ˜é‡Œ	157.0
ä¹ƒæœ¨å‚46	6æœŸ	éˆ´æœ¨ä½‘æº	157.0
ä¹ƒæœ¨å‚46	6æœŸ	é•·å¶‹å‡›æ¡œ	157.0
æ«»å‚46	4æœŸ	ä½è—¤æ„›æ¡œ	157.0
æ«»å‚46	4æœŸ	ä¸­å·æ™ºå°‹	157.0
æ¬…å‚46	1æœŸ	å°¾é–¢æ¢¨é¦™	156.5
æ—¥å‘å‚46	4æœŸ	å²¸å¸†å¤	156.5
ä¹ƒæœ¨å‚46	1æœŸ	å®‰è—¤ç¾é›²	156.0
ä¹ƒæœ¨å‚46	5æœŸ	ä¸€ãƒç€¬ç¾ç©º	156.0
ä¹ƒæœ¨å‚46	1æœŸ	äº•ä¸Šå°ç™¾åˆ	156.0
ä¹ƒæœ¨å‚46	3æœŸ	å¤§åœ’æ¡ƒå­	156.0
æ—¥å‘å‚46	1æœŸ	å½±å±±å„ªä½³	156.0
æ¬…å‚46	1æœŸ	åŸç”°è‘µ	156.0
æ«»å‚46	3æœŸ	æ‘äº•å„ª	156.0
æ¬…å‚46	1æœŸ	éˆ´æœ¬ç¾æ„‰	156.0
ä¹ƒæœ¨å‚46	4æœŸ	æ›æ©‹æ²™è€¶é¦™	156.0
ä¹ƒæœ¨å‚46	6æœŸ	å·ç«¯æ™ƒèœ	156.0
ä¹ƒæœ¨å‚46	6æœŸ	å¢—ç”°ä¸‰è‰éŸ³	156.0
ä¹ƒæœ¨å‚46	6æœŸ	æ£®å¹³éº—å¿ƒ	156.0
æ«»å‚46	4æœŸ	æµ…äº•æ‹ä¹ƒæœª	156.0
æ«»å‚46	4æœŸ	ç¨²ç†Šã²ãª	156.0
ä¹ƒæœ¨å‚46	5æœŸ	å·ï¨‘æ¡œ	155.0
ä¹ƒæœ¨å‚46	2æœŸ	å¯ºç”°è˜­ä¸–	155.0
ä¹ƒæœ¨å‚46	1æœŸ	æ˜Ÿé‡ã¿ãªã¿	155.0
ä¹ƒæœ¨å‚46	6æœŸ	å°æ´¥ç²å¥ˆ	155.0
æ—¥å‘å‚46	1æœŸ	é½Šè—¤äº¬å­	155.0
æ«»å‚46	2æœŸ	å¹¸é˜ªèŒ‰é‡Œä¹ƒ	154.5
æ—¥å‘å‚46	1æœŸ	æ±æ‘èŠ½ä¾	154.5
æ—¥å‘å‚46	2æœŸ	æ²³ç”°é™½èœ	154.5
æ—¥å‘å‚46	4æœŸ	ç«¹å†…å¸Œæ¥é‡Œ	154.5
ä¹ƒæœ¨å‚46	1.5æœŸ	ç§‹å…ƒçœŸå¤	154.0
ä¹ƒæœ¨å‚46	2æœŸ	ä¼Šè—¤ã‹ã‚Šã‚“	154.0
ä¹ƒæœ¨å‚46	3æœŸ	ä¼Šè—¤ç†ã€…æ	154.0
ä¹ƒæœ¨å‚46	5æœŸ	å°å·å½©	154.0
æ«»å‚46	2æœŸ	å®ˆå±‹éº—å¥ˆ	154.0
æ—¥å‘å‚46	4æœŸ	æ¸¡è¾ºè‰å¥ˆ	154.0
æ—¥å‘å‚46	5æœŸ	ä¸‹ç”°è¡£ç å­£	154.0
æ¬…å‚46/æ«»å‚46	1æœŸ	ä¸Šæ‘è‰èœ	153.5
æ—¥å‘å‚46	4æœŸ	çŸ³å¡šç‘¶å­£	153.5
ä¹ƒæœ¨å‚46	1æœŸ	ç”Ÿé§’é‡Œå¥ˆ	153.0
ä¹ƒæœ¨å‚46	1æœŸ	å¸‚ä¾†ç²å¥ˆ	153.0
ä¹ƒæœ¨å‚46	1æœŸ	å²©ç€¬ä½‘ç¾å­	153.0
ä¹ƒæœ¨å‚46	4æœŸ	çŸ¢ä¹…ä¿ç¾ç·’	153.0
ä¹ƒæœ¨å‚46	2æœŸ	æ¸¡è¾ºã¿ã‚Šæ„›	153.0
æ—¥å‘å‚46	1æœŸ	æ±æ‘èŠ½ä¾	153.0
æ—¥å‘å‚46	2æœŸ	æ²³ç”°é™½èœ	153.0
æ—¥å‘å‚46	5æœŸ	å¤§é‡æ„›å®Ÿ	153.0
æ—¥å‘å‚46	5æœŸ	è”µç››å¦ƒé‚£ä¹ƒ	153.0
ä¹ƒæœ¨å‚46	3æœŸ	ä¸ç”°ç¥å¸Œ	153.0
æ¬…å‚46	1æœŸ	ä»Šæ³‰ä½‘å”¯	153.0
ä¹ƒæœ¨å‚46	6æœŸ	ç€¬æˆ¸å£å¿ƒæœˆ	153.0
æ—¥å‘å‚46	3æœŸ	å±±å£é™½ä¸–	152.5
æ«»å‚46	3æœŸ	å±±ä¸‹ç³æœˆ	152.0
ä¹ƒæœ¨å‚46	3æœŸ	å‘äº•è‘‰æœˆ	152.0
æ«»å‚46	3æœŸ	è°·å£æ„›å­£	151.0
æ¬…å‚46/æ«»å‚46	2æœŸ	æ£®ç”°ã²ã‹ã‚‹	150.5
ä¹ƒæœ¨å‚46	1æœŸ	ç• ä¸­æ¸…ç¾…	150.0
ä¹ƒæœ¨å‚46	1æœŸ	ä¼Šè—¤å¯§ã€…	149.0`;

        // è™•ç†æ—¥æœ¬äººåï¼Œåœ¨å§“èˆ‡åä¹‹é–“åŠ ç©ºæ ¼
        function formatJapaneseName(name) {
            // ç‰¹æ®Šè™•ç†çš„åå­—
            const specialNames = {
                'å‰ç”°ç¶¾ä¹ƒã‚¯ãƒªã‚¹ãƒ†ã‚£ãƒ¼': 'å‰ç”° ç¶¾ä¹ƒã‚¯ãƒªã‚¹ãƒ†ã‚£ãƒ¼',
                'é è—¤ã•ãã‚‰': 'é è—¤ ã•ãã‚‰',
                'å’Œç”°ã¾ã‚ã‚„': 'å’Œç”° ã¾ã‚ã‚„',
                'é•·æ¿±ã­ã‚‹': 'é•·æ¿± ã­ã‚‹',
                'ä¸­è¥¿ã‚¢ãƒ«ãƒ': 'ä¸­è¥¿ ã‚¢ãƒ«ãƒ',
                'äº•ä¸Šå’Œ': 'äº•ä¸Š å’Œ',
                'å±±ï¨‘å¤©': 'å±±ï¨‘ å¤©',
                'æ¾äº•ç²å¥ˆ': 'æ¾äº• ç²å¥ˆ',
                'å°å·å½©': 'å°å· å½©',
                'æŸå¹¸å¥ˆ': 'æŸ å¹¸å¥ˆ',
                'å²¸å¸†å¤': 'å²¸ å¸†å¤',
                'æ¾å°¾æ¡œ': 'æ¾å°¾ æ¡œ',
                'å·ï¨‘æ¡œ': 'å·ï¨‘ æ¡œ',
                'å‹åˆæ˜¥': 'å‹åˆ æ˜¥',
                'æµ…äº•æ‹ä¹ƒæœª': 'æµ…äº• æ‹ä¹ƒæœª',
                'æ¾æœ¬å’Œå­': 'æ¾æœ¬ å’Œå­',
                'å±±å·å®‡è¡£': 'å±±å· å®‡è¡£',
                'ç›®é»’é™½è‰²': 'ç›®é»’ é™½è‰²',
                'ç¨²ç†Šã²ãª': 'ç¨²ç†Š ã²ãª',
                'ä½è—¤æ„›æ¡œ': 'ä½è—¤ æ„›æ¡œ',
                'ä¸­å·æ™ºå°‹': 'ä¸­å· æ™ºå°‹',
                'å±±ç”°æ¡ƒå®Ÿ': 'å±±ç”° æ¡ƒå®Ÿ'
            };
            
            if (specialNames[name]) {
                return specialNames[name];
            }
            
            // ä¸€èˆ¬è¦å‰‡è™•ç†
            if (name.length === 2) {
                return name[0] + ' ' + name[1];
            } else if (name.length === 3) {
                // å¤§éƒ¨åˆ†3å­—åæ˜¯2å­—å§“+1å­—å
                const twoCharSurnames = ['ä½ã€…æœ¨', 'ä½ã€…æœ¨', 'äº”ç™¾åŸ', 'å°ç”°å€‰', 'æ­£æºå¸', 'ç€¬æˆ¸å£'];
                for (let surname of twoCharSurnames) {
                    if (name.startsWith(surname)) {
                        return surname + ' ' + name.substring(surname.length);
                    }
                }
                // æª¢æŸ¥æ˜¯å¦ç‚º1å­—å§“+2å­—åçš„æ¨¡å¼
                const oneCharSurnamePattern = ['é–¢', 'å €', 'æ—', 'æ£®', 'åŸ', 'è…', 'è°·', 'ç• ', 'æ½®', 'å½±', 'å²¸'];
                if (oneCharSurnamePattern.includes(name[0])) {
                    return name[0] + ' ' + name.substring(1);
                }
                // é è¨­ç‚º2å­—å§“+1å­—å
                return name.substring(0, 2) + ' ' + name.substring(2);
            } else if (name.length === 4) {
                // æª¢æŸ¥3å­—å§“
                const threeCharSurnames = ['ä½ã€…æœ¨', 'äº”ç™¾åŸ', 'å°ç”°å€‰', 'æ­£æºå¸'];
                for (let surname of threeCharSurnames) {
                    if (name.startsWith(surname)) {
                        return surname + ' ' + name.substring(surname.length);
                    }
                }
                // é è¨­ç‚º2å­—å§“+2å­—å
                return name.substring(0, 2) + ' ' + name.substring(2);
            } else if (name.length >= 5) {
                // æª¢æŸ¥ç‰¹æ®Šçš„é•·å§“
                if (name.startsWith('ä½ã€…æœ¨')) {
                    return 'ä½ã€…æœ¨ ' + name.substring(3);
                } else if (name.startsWith('äº”ç™¾åŸ')) {
                    return 'äº”ç™¾åŸ ' + name.substring(3);
                } else if (name.startsWith('æ­£æºå¸')) {
                    return 'æ­£æºå¸ ' + name.substring(3);
                }
                // é è¨­ç‚º2å­—å§“
                return name.substring(0, 2) + ' ' + name.substring(2);
            }
            
            return name;
        }

        // è§£æè³‡æ–™
        function parseData() {
            const lines = rawData.trim().split('\n');
            const data = [];
            const uniqueMembers = new Set();
            
            for (let i = 1; i < lines.length; i++) {
                const parts = lines[i].split('\t');
                if (parts.length === 4) {
                    // è™•ç†åœ˜é«”åç¨±
                    let group = parts[0];
                    if (group.includes('æ¬…å‚46')) {
                        group = group.replace('æ¬…å‚46', 'æ«»å‚46');
                    }
                    if (group.includes('ã‘ã‚„ãå‚46')) {
                        group = group.replace('ã‘ã‚„ãå‚46', 'æ—¥å‘å‚46');
                    }
                    group = group.split('/')[0];
                    
                    // è™•ç†æœŸåˆ¥ï¼ˆå°‡1.5æœŸåˆä½µåˆ°1æœŸï¼‰
                    let period = parts[1];
                    if (period === '1.5æœŸ') {
                        period = '1æœŸ';
                    }
                    
                    // æ ¼å¼åŒ–åå­—
                    const formattedName = formatJapaneseName(parts[2]);
                    
                    const memberKey = `${group}_${parts[2]}`;
                    if (!uniqueMembers.has(memberKey)) {
                        uniqueMembers.add(memberKey);
                        data.push({
                            group: group,
                            period: period,
                            name: formattedName,
                            height: parseFloat(parts[3])
                        });
                    }
                }
            }
            return data;
        }

        const data = parseData();

        // è¨ˆç®—çµ±è¨ˆåƒæ•¸
        function calculateStats(heights) {
            const n = heights.length;
            const mean = heights.reduce((a, b) => a + b, 0) / n;
            const sorted = [...heights].sort((a, b) => a - b);
            const median = n % 2 === 0 ? 
                (sorted[n/2 - 1] + sorted[n/2]) / 2 : 
                sorted[Math.floor(n/2)];
            const variance = heights.reduce((acc, h) => acc + Math.pow(h - mean, 2), 0) / n;
            const stdDev = Math.sqrt(variance);
            
            return {
                count: n,
                mean: mean.toFixed(2),
                median: median.toFixed(2),
                stdDev: stdDev.toFixed(2),
                min: Math.min(...heights).toFixed(1),
                max: Math.max(...heights).toFixed(1)
            };
        }

        // é¡¯ç¤ºç¸½é«”çµ±è¨ˆ
        const heights = data.map(d => d.height);
        const stats = calculateStats(heights);
        document.getElementById('totalCount').textContent = stats.count;
        document.getElementById('meanHeight').textContent = stats.mean + ' cm';
        document.getElementById('medianHeight').textContent = stats.median + ' cm';
        document.getElementById('stdDev').textContent = stats.stdDev + ' cm';
        document.getElementById('minHeight').textContent = stats.min + ' cm';
        document.getElementById('maxHeight').textContent = stats.max + ' cm';

        // é‡å¯«ç›´æ–¹åœ–å‡½æ•¸
        function createHistogram() {
            // ç¢ºä¿ canvas å­˜åœ¨
            const canvas = document.getElementById('histogramChart');
            if (!canvas) {
                console.error('Canvas element histogramChart not found');
                setTimeout(createHistogram, 500);
                return;
            }
            
            // æº–å‚™æ•¸æ“š
            const bins = {
                '149-151': 0,
                '151-153': 0,
                '153-155': 0,
                '155-157': 0,
                '157-159': 0,
                '159-161': 0,
                '161-163': 0,
                '163-165': 0,
                '165-167': 0,
                '167-169': 0,
                '169-171': 0,
                '171-173': 0
            };
            
            // è¨ˆç®—æ¯å€‹å€é–“çš„äººæ•¸
            heights.forEach(h => {
                if (h >= 149 && h < 151) bins['149-151']++;
                else if (h >= 151 && h < 153) bins['151-153']++;
                else if (h >= 153 && h < 155) bins['153-155']++;
                else if (h >= 155 && h < 157) bins['155-157']++;
                else if (h >= 157 && h < 159) bins['157-159']++;
                else if (h >= 159 && h < 161) bins['159-161']++;
                else if (h >= 161 && h < 163) bins['161-163']++;
                else if (h >= 163 && h < 165) bins['163-165']++;
                else if (h >= 165 && h < 167) bins['165-167']++;
                else if (h >= 167 && h < 169) bins['167-169']++;
                else if (h >= 169 && h < 171) bins['169-171']++;
                else if (h >= 171 && h < 173) bins['171-173']++;
            });
            
            // éŠ·æ¯€èˆŠåœ–è¡¨
            if (charts.histogram) {
                charts.histogram.destroy();
                charts.histogram = null;
            }
            
            // å‰µå»ºæ–°åœ–è¡¨
            const ctx = canvas.getContext('2d');
            charts.histogram = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(bins),
                    datasets: [{
                        label: 'äººæ•¸',
                        data: Object.values(bins),
                        backgroundColor: 'rgba(102, 126, 234, 0.7)',
                        borderColor: 'rgba(102, 126, 234, 1)',
                        borderWidth: 2,
                        barPercentage: 0.9,
                        categoryPercentage: 1.0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return 'äººæ•¸: ' + context.parsed.y + ' äºº';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            min: 0,
                            max: 40,
                            ticks: {
                                stepSize: 10
                            },
                            title: {
                                display: true,
                                text: 'äººæ•¸'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'èº«é«˜å€é–“ (cm)'
                            }
                        }
                    }
                }
            });
        }

        // å»ºç«‹åœ˜é«”æ¯”è¼ƒåœ–
        function createGroupChart() {
            const ctx = document.getElementById('groupChart');
            if (!ctx) return;
            
            const groupStats = {};
            
            data.forEach(d => {
                if (!groupStats[d.group]) {
                    groupStats[d.group] = [];
                }
                groupStats[d.group].push(d.height);
            });
            
            // æŒ‡å®šé †åºï¼šä¹ƒæœ¨å‚46ã€æ«»å‚46ã€æ—¥å‘å‚46
            const orderedGroups = ['ä¹ƒæœ¨å‚46', 'æ«»å‚46', 'æ—¥å‘å‚46'];
            const labels = orderedGroups.filter(g => groupStats[g]);
            const means = labels.map(g => 
                (groupStats[g].reduce((a, b) => a + b, 0) / groupStats[g].length).toFixed(2)
            );
            const counts = labels.map(g => groupStats[g].length);
            
            // éŠ·æ¯€èˆŠåœ–è¡¨
            if (charts.group) {
                charts.group.destroy();
            }
            
            charts.group = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'å¹³å‡èº«é«˜ (cm)',
                        data: means,
                        backgroundColor: [
                            'rgba(148, 0, 211, 0.7)',  // ä¹ƒæœ¨å‚46 - ç´«è‰²
                            'rgba(255, 182, 193, 0.7)', // æ«»å‚46 - ç²‰è‰²
                            'rgba(135, 206, 235, 0.7)'  // æ—¥å‘å‚46 - å¤©è—è‰²
                        ],
                        borderColor: [
                            'rgba(148, 0, 211, 1)',
                            'rgba(255, 182, 193, 1)',
                            'rgba(135, 206, 235, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            formatter: (value, ctx) => {
                                return value + ' cm\n(n=' + counts[ctx.dataIndex] + ')';
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 155,
							max: 162,
                            title: {
                                display: true,
                                text: 'å¹³å‡èº«é«˜ (cm)'
                            }
                        }
                    }
                }
            });
        }

        // å»ºç«‹ç®±å½¢åœ–ï¼ˆç°¡åŒ–ç‰ˆï¼‰
        function createBoxChart() {
            const ctx = document.getElementById('boxChart');
            if (!ctx) return;
            
            const groupData = {};
            
            data.forEach(d => {
                if (!groupData[d.group]) {
                    groupData[d.group] = [];
                }
                groupData[d.group].push(d.height);
            });
            
            // æŒ‡å®šé †åº
            const orderedGroups = ['ä¹ƒæœ¨å‚46', 'æ«»å‚46', 'æ—¥å‘å‚46'];
            const labels = orderedGroups.filter(g => groupData[g]);
            
            const boxData = labels.map(group => {
                const sorted = groupData[group].sort((a, b) => a - b);
                const q1 = sorted[Math.floor(sorted.length * 0.25)];
                const median = sorted[Math.floor(sorted.length * 0.5)];
                const q3 = sorted[Math.floor(sorted.length * 0.75)];
                const min = sorted[0];
                const max = sorted[sorted.length - 1];
                
                return {
                    min: min.toFixed(1),
                    q1: q1.toFixed(1),
                    median: median.toFixed(1),
                    q3: q3.toFixed(1),
                    max: max.toFixed(1)
                };
            });
            
            // éŠ·æ¯€èˆŠåœ–è¡¨
            if (charts.box) {
                charts.box.destroy();
            }
            
            // ä½¿ç”¨é•·æ¢åœ–æ¨¡æ“¬ç®±å½¢åœ–
            charts.box = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'æœ€å°å€¼',
                            data: boxData.map(d => d.min),
                            backgroundColor: 'rgba(255, 99, 132, 0.3)'
                        },
                        {
                            label: 'Q1',
                            data: boxData.map(d => d.q1),
                            backgroundColor: 'rgba(54, 162, 235, 0.3)'
                        },
                        {
                            label: 'ä¸­ä½æ•¸',
                            data: boxData.map(d => d.median),
                            backgroundColor: 'rgba(255, 206, 86, 0.3)'
                        },
                        {
                            label: 'Q3',
                            data: boxData.map(d => d.q3),
                            backgroundColor: 'rgba(75, 192, 192, 0.3)'
                        },
                        {
                            label: 'æœ€å¤§å€¼',
                            data: boxData.map(d => d.max),
                            backgroundColor: 'rgba(153, 102, 255, 0.3)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 145,
                            title: {
                                display: true,
                                text: 'èº«é«˜ (cm)'
                            }
                        }
                    }
                }
            });
        }

        // å»ºç«‹å„åœ˜é«”æœŸåˆ¥åˆ†æåœ–
        function createPeriodChartByGroup(group, canvasId, color) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            const periodStats = {};
            
            // éæ¿¾è©²åœ˜é«”ä¸”ä¸åŒ…å«äº¤æ›ç•™å­¸ç”Ÿçš„è³‡æ–™
            const groupData = data.filter(d => d.group === group && !d.period.includes('äº¤æ›'));
            
            groupData.forEach(d => {
                const period = d.period;
                if (!periodStats[period]) {
                    periodStats[period] = [];
                }
                periodStats[period].push(d.height);
            });
            
            // æ’åºæœŸåˆ¥
            const sortedPeriods = Object.keys(periodStats).sort((a, b) => {
                const getNumValue = (str) => {
                    const num = parseInt(str.replace(/[^\d]/g, ''));
                    return isNaN(num) ? 1000 : num;
                };
                return getNumValue(a) - getNumValue(b);
            });
            
            const labels = sortedPeriods.map(p => {
                const num = p.replace(/[^\d]/g, '');
                return num ? `${num}æœŸ` : p;
            });
            
            const means = sortedPeriods.map(p => 
                (periodStats[p].reduce((a, b) => a + b, 0) / periodStats[p].length).toFixed(2)
            );
            
            const counts = sortedPeriods.map(p => periodStats[p].length);
            
            // éŠ·æ¯€èˆŠåœ–è¡¨
            if (charts[canvasId]) {
                charts[canvasId].destroy();
            }
            
            charts[canvasId] = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'å¹³å‡èº«é«˜',
                        data: means,
                        borderColor: color,
                        backgroundColor: color.replace('1)', '0.2)'),
                        tension: 0.1,
                        fill: true,
                        pointRadius: 5,
                        pointHoverRadius: 7
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        datalabels: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                afterLabel: function(context) {
                                    return 'äººæ•¸: ' + counts[context.dataIndex] + ' äºº';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 150,
                            max: 170,
                            title: {
                                display: true,
                                text: 'å¹³å‡èº«é«˜ (cm)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'æœŸåˆ¥'
                            }
                        }
                    }
                }
            });
        }

        // å»ºç«‹åœ“é¤…åœ–
        function createPieChart() {
            const ctx = document.getElementById('pieChart');
            if (!ctx) return;
            
            const ranges = {
                '149-155 cm': 0,
                '155-160 cm': 0,
                '160-165 cm': 0,
                '165-170 cm': 0,
                '170+ cm': 0
            };
            
            heights.forEach(h => {
                if (h < 155) ranges['149-155 cm']++;
                else if (h < 160) ranges['155-160 cm']++;
                else if (h < 165) ranges['160-165 cm']++;
                else if (h < 170) ranges['165-170 cm']++;
                else ranges['170+ cm']++;
            });
            
            // éŠ·æ¯€èˆŠåœ–è¡¨
            if (charts.pie) {
                charts.pie.destroy();
            }
            
            charts.pie = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(ranges),
                    datasets: [{
                        data: Object.values(ranges),
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(153, 102, 255, 0.7)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
        }

        // å»ºç«‹æ’åè¡¨
        function createRankingTable() {
            const sortedData = [...data].sort((a, b) => b.height - a.height);
            const tbody = document.getElementById('rankingBody');
            tbody.innerHTML = '';
            
            sortedData.forEach((member, index) => {
                const row = tbody.insertRow();
                row.insertCell(0).textContent = index + 1;
                row.insertCell(1).textContent = member.name;
                row.insertCell(2).textContent = member.group;
                row.insertCell(3).textContent = member.period;
                row.insertCell(4).textContent = member.height.toFixed(1);
            });
        }

        // æ¨™ç±¤åˆ‡æ›åŠŸèƒ½
        function showTab(tabName, button) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-button');
            
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            button.classList.add('active');
            
            // å»¶é²è¼‰å…¥åœ–è¡¨ä»¥ç¢ºä¿é¡¯ç¤ºæ­£ç¢º
            setTimeout(() => {
                if (tabName === 'overview') {
                    createHistogram();
                }
                if (tabName === 'byGroup') {
                    createGroupChart();
                    createBoxChart();
                }
                if (tabName === 'byPeriod') {
                    createPeriodChartByGroup('ä¹ƒæœ¨å‚46', 'nogizakaPeriodChart', 'rgba(148, 0, 211, 1)');
                    createPeriodChartByGroup('æ«»å‚46', 'sakurazakaPeriodChart', 'rgba(255, 182, 193, 1)');
                    createPeriodChartByGroup('æ—¥å‘å‚46', 'hinatazakaPeriodChart', 'rgba(135, 206, 235, 1)');
                }
                if (tabName === 'distribution') {
                    createPieChart();
                }
            }, 100);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            createRankingTable();
            // å»¶é²å‰µå»ºç›´æ–¹åœ–ï¼Œç¢ºä¿ DOM å®Œå…¨è¼‰å…¥
            setTimeout(() => {
                createHistogram();
            }, 200);
        });
    </script>
</body>
</html>
